# üèîÔ∏è DQN Agent –¥–ª—è MountainCar-v0

–ì–ª—É–±–æ–∫–∞—è Q-—Å–µ—Ç—å (Deep Q-Network) –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ MountainCar-v0 –æ—Ç OpenAI Gym. –ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è —Å –ø–æ–¥–∫—Ä–µ–ø–ª–µ–Ω–∏–µ–º –¥–ª—è –æ—Å–≤–æ–µ–Ω–∏—è —Å–ª–æ–∂–Ω–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ä–∞—Å–∫–∞—á–∫–∏.

## üìñ –û –ø—Ä–æ–µ–∫—Ç–µ

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é **Deep Q-Network (DQN)** –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π –∑–∞–¥–∞—á–∏ **MountainCar-v0** –∏–∑ OpenAI Gym. 
–ê–≥–µ–Ω—Ç –æ–±—É—á–∞–µ—Ç—Å—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ä–∞—Å–∫–∞—á–∫–∏ –º–∞—à–∏–Ω—ã –¥–ª—è –ø—Ä–µ–æ–¥–æ–ª–µ–Ω–∏—è –∫—Ä—É—Ç–æ–≥–æ —Ö–æ–ª–º–∞, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—è –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω—É—é —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å **100% —É—Å–ø–µ—à–Ω–æ—Å—Ç—å—é** –ø—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏.

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [–û–±–∑–æ—Ä](#1-–æ–±–∑–æ—Ä)
- [–†–µ–∑—É–ª—å—Ç–∞—Ç—ã](#2-—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã)
- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#3-–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#4-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
- [–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è](#5-–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è)
- [–î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑](#6-–¥–µ—Ç–∞–ª—å–Ω—ã–π-–∞–Ω–∞–ª–∏–∑)
- [–§–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞](#7-—Ñ–∞–π–ª—ã-–ø—Ä–æ–µ–∫—Ç–∞)
- [–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è](#8-–¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è)

<a id="1-–æ–±–∑–æ—Ä"></a>
## üéØ –û–±–∑–æ—Ä

**–ó–∞–¥–∞—á–∞**: –û–±—É—á–∏—Ç—å –º–∞—à–∏–Ω–∫—É –≤–∑–±–∏—Ä–∞—Ç—å—Å—è –Ω–∞ –∫—Ä—É—Ç–æ–π —Ö–æ–ª–º, –∏—Å–ø–æ–ª—å–∑—É—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—É—é –º–æ—â–Ω–æ—Å—Ç—å –¥–≤–∏–≥–∞—Ç–µ–ª—è. –¢—Ä–µ–±—É–µ—Ç—Å—è –æ—Å–≤–æ–∏—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é —Ä–∞—Å–∫–∞—á–∫–∏ –¥–ª—è –Ω–∞–±–æ—Ä–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π –∏–Ω–µ—Ä—Ü–∏–∏.

![MountainCar Environment](https://www.gymlibrary.dev/_images/mountain_car_continuous.gif)

**–°—Ä–µ–¥–∞**: `MountainCar-v0`
- **–°–æ—Å—Ç–æ—è–Ω–∏–µ**: [–ø–æ–∑–∏—Ü–∏—è (-1.2 –¥–æ 0.6), —Å–∫–æ—Ä–æ—Å—Ç—å (-0.07 –¥–æ 0.07)]
- **–î–µ–π—Å—Ç–≤–∏—è**: 0-–≤–ª–µ–≤–æ, 1-—Å—Ç–æ–ø, 2-–≤–ø—Ä–∞–≤–æ
- **–¶–µ–ª—å**: –¥–æ—Å—Ç–∏—á—å —Ñ–ª–∞–≥–∞ –Ω–∞ –ø–æ–∑–∏—Ü–∏–∏ ‚â• 0.5
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å**: —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã–µ –Ω–∞–≥—Ä–∞–¥—ã, —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

<a id="2-—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã"></a>
## üèÜ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### üìä –û–±—É—á–µ–Ω–∏–µ
- **–≠–ø–∏–∑–æ–¥–æ–≤**: 20,767
- **–£—Å–ø–µ—à–Ω—ã—Ö —ç–ø–∏–∑–æ–¥–æ–≤**: 1,126
- **–û–±—â–∞—è —É—Å–ø–µ—à–Ω–æ—Å—Ç—å**: 5.4%
- **–õ—É—á—à–∞—è –ø–æ–∑–∏—Ü–∏—è**: 0.548
- **–°—Ä–µ–¥–Ω–∏–µ —à–∞–≥–∏**: 966.1

### üéØ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–£—Å–ø–µ—à–Ω–æ—Å—Ç—å**: **100.0%**
- **–°—Ä–µ–¥–Ω–∏–µ —à–∞–≥–∏**: **134.9**
- **–°—Ä–µ–¥–Ω—è—è –ø–æ–∑–∏—Ü–∏—è**: 0.517

### üìà –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ —Ñ–∞–∑–∞–º
| –§–∞–∑–∞         | –£—Å–ø–µ—à–Ω–æ—Å—Ç—å | –ü–æ–∑–∏—Ü–∏—è | –®–∞–≥–∏  |
|--------------|------------|---------|-------|
| 1-—è —á–µ—Ç–≤–µ—Ä—Ç—å | 0.8%       | -0.192  | 997.9 |
| 2-—è —á–µ—Ç–≤–µ—Ä—Ç—å | 0.7%       | -0.205  | 995.5 |
| 3-—è —á–µ—Ç–≤–µ—Ä—Ç—å | 4.1%       | -0.175  | 971.3 |
| 4-—è —á–µ—Ç–≤–µ—Ä—Ç—å | 16.0%      | -0.088  | 899.7 |

<a id="3-–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç"></a>
## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install gymnasium torch matplotlib numpy
```

### –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è

```bash
python Kyrsovoy_AI Gym.py
```
### –ó–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

** –ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å**
```bash
# –ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å
agent = DQNAgent(state_size=2, action_size=3)
agent.model.load_state_dict(torch.load('mountain_car_final.pth'))
results = run_final_evaluation(agent, num_episodes=50)
```

<a id="4-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞"></a>
## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

**–ù–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å DQN**

```bash
DQN(
  (fc1): Linear(2 ‚Üí 256) + ReLU
  (fc2): Linear(256 ‚Üí 256) + ReLU  
  (fc3): Linear(256 ‚Üí 128) + ReLU
  (fc4): Linear(128 ‚Üí 3)
)
```
# –ê–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

- Double DQN - –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø–µ—Ä–µ–æ—Ü–µ–Ω–∫–∏ Q-–∑–Ω–∞—á–µ–Ω–∏–π

- –¶–µ–ª–µ–≤–∞—è —Å–µ—Ç—å - —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è –æ–±—É—á–µ–Ω–∏—è

- Huber Loss - —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –≤—ã–±—Ä–æ—Å–∞–º

- –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π –∫–ª–∏–ø–ø–∏–Ω–≥ - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤

- –£–ª—É—á—à–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–∞–≥—Ä–∞–¥ - –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ

## –ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã

```bash
gamma = 0.99
epsilon_start = 1.0
epsilon_min = 0.05
epsilon_decay = 0.9995
learning_rate = 0.00025
batch_size = 128
memory_size = 100,000
update_target_every = 100
```

<a id="5-–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è"></a>
## üìä –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

–ü—Ä–æ–≥—Ä–∞–º–º–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ –∞–Ω–∞–ª–∏–∑–∞ –≤ —Ñ–∞–π–ª–µ mountain_car_final_analysis.png:

**–ì—Ä–∞—Ñ–∏–∫–∏ –≤–∫–ª—é—á–∞—é—Ç:**

1. –ü—Ä–æ–≥—Ä–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è - –¥–∏–Ω–∞–º–∏–∫–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π

2. –£—Å–ø–µ—à–Ω–æ—Å—Ç—å - —Å–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ –∑–∞ 100 —ç–ø–∏–∑–æ–¥–æ–≤

3. –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π - –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ —É—Å–ø–µ—à–Ω—ã—Ö/–Ω–µ—É—Å–ø–µ—à–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫

4. –®–∞–≥–∏ –ø–æ —ç–ø–∏–∑–æ–¥–∞–º - —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

5. –ù–∞–≥—Ä–∞–¥—ã –ø–æ —ç–ø–∏–∑–æ–¥–∞–º - –¥–∏–Ω–∞–º–∏–∫–∞ –ø–æ–ª—É—á–∞–µ–º—ã—Ö –Ω–∞–≥—Ä–∞–¥

6. –§–∏–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å - –ø–æ—Å–ª–µ–¥–Ω–∏–µ 200 —ç–ø–∏–∑–æ–¥–æ–≤

<a id="6-–¥–µ—Ç–∞–ª—å–Ω—ã–π-–∞–Ω–∞–ª–∏–∑"></a>
## üîç –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è –æ–±—É—á–µ–Ω–∏—è**

1. –§–∞–∑–∞ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è (0-5K —ç–ø–∏–∑–æ–¥–æ–≤): —Å–ª—É—á–∞–π–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è, –Ω–∏–∑–∫–∞—è —É—Å–ø–µ—à–Ω–æ—Å—Ç—å

2. –§–∞–∑–∞ –∫–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏–∏ (5-10K —ç–ø–∏–∑–æ–¥–æ–≤): —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è, –≤–æ–∑–º–æ–∂–Ω—ã–π —Ä–µ–≥—Ä–µ—Å—Å

3. –§–∞–∑–∞ –ø—Ä–æ—Ä—ã–≤–∞ (10-15K —ç–ø–∏–∑–æ–¥–æ–≤): —Ä–µ–∑–∫–∏–π —Ä–æ—Å—Ç —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏

4. –§–∞–∑–∞ –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–∞ (15-20.7K —ç–ø–∏–∑–æ–¥–æ–≤): —Å—Ç–∞–±–∏–ª—å–Ω–æ –≤—ã—Å–æ–∫–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

## –°–∏—Å—Ç–µ–º–∞ –Ω–∞–≥—Ä–∞–¥

```bash
if position >= 0.5:
    reward = 100.0  # –ö—Ä—É–ø–Ω–∞—è –Ω–∞–≥—Ä–∞–¥–∞ –∑–∞ —É—Å–ø–µ—Ö
else:
    reward = position * 10        # –ü–æ–æ—â—Ä–µ–Ω–∏–µ –∑–∞ –≤—ã—Å–æ—Ç—É
    reward += abs(velocity) * 5   # –ë–æ–Ω—É—Å –∑–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ
    reward -= 0.1                 # –®—Ç—Ä–∞—Ñ –∑–∞ –≤—Ä–µ–º—è
```

## –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- –†–∞–Ω–Ω—è—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ 90% —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏

- –ú–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –Ω–∞ –±–∞—Ç—á–µ (4 —Ä–∞–∑–∞ –∑–∞ —ç–ø–∏–∑–æ–¥)

- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π Œµ-greedy —Å –ø–ª–∞–≤–Ω—ã–º —É–º–µ–Ω—å—à–µ–Ω–∏–µ–º

- –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∫–∞–∂–¥—ã–µ 100 —ç–ø–∏–∑–æ–¥–æ–≤

<a id="7-—Ñ–∞–π–ª—ã-–ø—Ä–æ–µ–∫—Ç–∞"></a>
## üìÅ –§–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã**
```
üì¶ MountainCar-DQN/
‚îú‚îÄ‚îÄ üìÑ Kyrsovoy_AI Gym.py              # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ –æ–±—É—á–µ–Ω–∏—è
‚îú‚îÄ‚îÄ üìÑ mountain_car_final.pth          # –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –≤–µ—Å–∞ –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ üìä mountain_car_final_analysis.png # –ì—Ä–∞—Ñ–∏–∫–∏ –∞–Ω–∞–ª–∏–∑–∞
‚îú‚îÄ‚îÄ üìñ README.md                       # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îî‚îÄ‚îÄ üêç requirements.txt               # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ)
```
## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–¥–∞

- DQN Class - –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏

- DQNAgent Class - –ª–æ–≥–∏–∫–∞ –∞–≥–µ–Ω—Ç–∞ –∏ –æ–±—É—á–µ–Ω–∏—è

- train_mountain_car_final() - –æ—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –æ–±—É—á–µ–Ω–∏—è

- analyze_final_results() - —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑

- create_comprehensive_plots() - –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

- run_final_evaluation() - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏

<a id="8-–¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è"></a>
## üéØ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è

**‚úÖ –†–µ—à–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã**

- –ü—Ä–æ–±–ª–µ–º–∞ —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã—Ö –Ω–∞–≥—Ä–∞–¥ - —á–µ—Ä–µ–∑ —É–ª—É—á—à–µ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –Ω–∞–≥—Ä–∞–¥—ã

- –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è - —á–µ—Ä–µ–∑ Double DQN –∏ —Ü–µ–ª–µ–≤—É—é —Å–µ—Ç—å

- –î–æ–ª–≥–æ–µ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è - —á–µ—Ä–µ–∑ —Ä–∞–Ω–Ω—é—é –æ—Å—Ç–∞–Ω–æ–≤–∫—É –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

**üèÖ –ö–ª—é—á–µ–≤—ã–µ —É—Å–ø–µ—Ö–∏**

- 100% —É—Å–ø–µ—à–Ω–æ—Å—Ç—å –ø—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏

- –û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è - 135 —à–∞–≥–æ–≤ –≤ —Å—Ä–µ–¥–Ω–µ–º

- –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

- –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ–±—É—á–µ–Ω–∏—è

