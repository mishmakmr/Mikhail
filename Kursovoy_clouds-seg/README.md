# üõ∞Ô∏è –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–ª–∞–∫–æ–≤ –Ω–∞ —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã—Ö —Å–Ω–∏–º–∫–∞—Ö
**–ê–Ω—Å–∞–º–±–ª–µ–≤–æ–µ –≥–ª—É–±–æ–∫–æ–µ –æ–±—É—á–µ–Ω–∏–µ –¥–ª—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–π —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏**

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ
- [–û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞](#–æ–±–∑–æ—Ä-–ø—Ä–æ–µ–∫—Ç–∞)
- [–ö–ª—é—á–µ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã](#–∫–ª—é—á–µ–≤—ã–µ-—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∏-–∑–∞–ø—É—Å–∫)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏](#—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ-–¥–µ—Ç–∞–ª–∏)

<a id="–æ–±–∑–æ—Ä-–ø—Ä–æ–µ–∫—Ç–∞"></a>
## üéØ –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞
–ü—Ä–æ–µ–∫—Ç –ø–æ—Å–≤—è—â–µ–Ω —Ä–µ—à–µ–Ω–∏—é –∑–∞–¥–∞—á–∏ **—Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–π —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –æ–±–ª–∞–∫–æ–≤ —Ç–∏–ø–∞ "Fish"** –Ω–∞ —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã—Ö —Å–Ω–∏–º–∫–∞—Ö. –†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–Ω—Å–∞–º–±–ª—å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –≤—ã–¥–µ–ª–µ–Ω–∏—è –æ–±–ª–∞—á–Ω—ã—Ö –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π.

### üéØ –¶–µ–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞
- –°–æ–∑–¥–∞–Ω–∏–µ robust-–º–æ–¥–µ–ª–∏ –¥–ª—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –æ–±–ª–∞–∫–æ–≤
- –†–µ–∞–ª–∏–∑–∞—Ü–∏—è end-to-end –ø–∞–π–ø–ª–∞–π–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –≤—ã—Å–æ–∫–∏—Ö –º–µ—Ç—Ä–∏–∫ –∫–∞—á–µ—Å—Ç–≤–∞ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ
- –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ submission-—Ñ–∞–π–ª–∞ –¥–ª—è —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–π

<a id="–∫–ª—é—á–µ–≤—ã–µ-—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã"></a>
## üìä –ö–ª—é—á–µ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
** üèÜ –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞**

| 			–ú–µ—Ç—Ä–∏–∫–∞        | 	–ó–Ω–∞—á–µ–Ω–∏–µ    | 			–û–ø–∏—Å–∞–Ω–∏–µ               |
|--------------------------|----------------|----------------------------------|
| **Dice Coefficient**     | **0.7786**     | –û—Å–Ω–æ–≤–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏     |
| **–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥**    | **0.350**      | –õ—É—á—à–∏–π –ø–æ—Ä–æ–≥ –±–∏–Ω–∞—Ä–∏–∑–∞—Ü–∏–∏         |
| **–ù–µ–ø—É—Å—Ç—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è**| **1,130/3,698**| 30.6% –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å–æ–¥–µ—Ä–∂–∞—Ç –æ–±–ª–∞–∫–∞|

** üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π**

–í—Å–µ–≥–æ —Å—Ç—Ä–æ–∫ –≤ submission: 14,792
–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –¥–ª—è Fish: 3,698
–ù–µ–ø—É—Å—Ç—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è Fish: 1,130 (30.6%)


** üé® –ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–∏**

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å–∫—Ä–∏–ø—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è —Ñ–∞–π–ª `segmentation_example.png`, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π:
- –ò—Å—Ö–æ–¥–Ω–æ–µ —Å–ø—É—Ç–Ω–∏–∫–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
- Ground truth –º–∞—Å–∫—É (—Ä–∞–∑–º–µ—Ç–∫–∞)
- –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ —Å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º –ø–æ—Ä–æ–≥–æ–º

** üé® –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤**
https://raw.githubusercontent.com/mishmakmr/Mikhail/master/Kursovoy_clouds-seg/images/segmentation_example.png

–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, ground truth –º–∞—Å–∫–∏ –∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–æ–¥–µ–ª–∏

<a id="–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞"></a>
## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
**ü§ñ –ê–Ω—Å–∞–º–±–ª—å –º–æ–¥–µ–ª–µ–π**

```python
#–ö–æ–º–±–∏–Ω–∞—Ü–∏—è –¥–≤—É—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä
models = {
    'FPN': 'MobilNetV2 backbone',
    'U-Net': 'ResNet50 backbone' 
}

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è –∞–Ω—Å–∞–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
predictions = (fpn_pred + unet_pred) / 2.0
```
** üìê –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫**
- –§—Ä–µ–π–º–≤–æ—Ä–∫–∏: TensorFlow 2.12, Keras
- –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏: Segmentation Models, OpenCV, scikit-learn
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö: Pandas, NumPy
- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è: Matplotlib

<a id="—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∏-–∑–∞–ø—É—Å–∫"></a>
## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫
**–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è**
	- Python 3.8+
	- 8GB+ RAM
	- GPU —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
	
**–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**
pip install -r requirements.txt

**–ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞**
python Kursovoy_clouds-seg.py

### üöÄ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞
**–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç:**

- ‚úÖ –ó–∞–≥—Ä—É–∑–∫—É –∏ —Ä–∞—Å–ø–∞–∫–æ–≤–∫—É –¥–∞—Ç–∞—Å–µ—Ç–∞

- ‚úÖ –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫—É –∏ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö

- ‚úÖ –û–±—É—á–µ–Ω–∏–µ –∞–Ω—Å–∞–º–±–ª—è –º–æ–¥–µ–ª–µ–π

- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—é submission-—Ñ–∞–π–ª–∞

- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π

<a id="—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞"></a>
## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
Kursovoy_clouds-seg/
|
|‚îÄ‚îÄ üìä –ú–æ–¥–µ–ª–∏/
|   ‚îú‚îÄ‚îÄ fpn_mobilenetv2_best.h5
|   ‚îî‚îÄ‚îÄ unet_resnet50_best.h5
|
|‚îÄ‚îÄ üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã/
|   ‚îú‚îÄ‚îÄ submission.csv          # –§–∏–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
|   ‚îî‚îÄ‚îÄ segmentation_example.png # –ü—Ä–∏–º–µ—Ä –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
|
|‚îÄ‚îÄ üêç –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥/
|   ‚îî‚îÄ‚îÄ Kursovoy_clouds-seg.py  # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç
|
‚îî‚îÄ‚îÄ üìÑ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è/
    ‚îú‚îÄ‚îÄ README.md
    ‚îî‚îÄ‚îÄ requirements.txt

<a id="—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ-–¥–µ—Ç–∞–ª–∏"></a>
## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏
**üéØ –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã**
1. **–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö**
	- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å competition hosting
	- RLE –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Å–æ–∫
	- –†–µ—Å–∞–π–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–æ 224√ó224

2. **–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞**
```
# –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è
datagen = ImageDataGenerator(
    rotation_range=10,
    horizontal_flip=True,
    zoom_range=0.1
)
```
3. **–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π**
	- FPN —Å MobileNetV2 (20 —ç–ø–æ—Ö)
	- U-Net —Å ResNet50 (20 —ç–ø–æ—Ö)
	- Early Stopping –∏ Model Checkpoint
	
4. –ê–Ω—Å–∞–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
	- –£—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
	- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ä–æ–≥–∞ –±–∏–Ω–∞—Ä–∏–∑–∞—Ü–∏–∏
	- RLE –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### üìä –ú–µ—Ç—Ä–∏–∫–∏ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è
```
def dice_coef_np(y_true, y_pred, threshold=0.5):
    """–í—ã—á–∏—Å–ª–µ–Ω–∏–µ Dice coefficient"""
    y_pred_bin = (y_pred > threshold).astype(np.float32)
    intersection = np.sum(y_true * y_pred_bin)
    return (2. * intersection + smooth) / (np.sum(y_true) + np.sum(y_pred_bin) + smooth)
```	

###  üí° –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
**üé® –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π**
```
#–ü—Ä–∏–º–µ—Ä RLE –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
Image: 002f507.jpg_Fish
RLE: 102836 1 103361 1 103886 1 104411 1 104934 3...
```

### üì§ –§–æ—Ä–º–∞—Ç submission-—Ñ–∞–π–ª–∞
```
Image_Label,EncodedPixels
002f507.jpg_Fish,102836 1 103361 1...
0038327.jpg_Fish,38765 1 39290 1...
006440a.jpg_Fish,37176 3 37700 5...
```

### üéØ –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã —Ä–µ—à–µ–Ω–∏—è
**üèÖ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è**
	- –í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ - Dice 0.7786
	- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω - –ø–æ–ª–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
	- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∞–Ω—Å–∞–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ - –∫–æ–º–±–∏–Ω–∞—Ü–∏—è —Å–∏–ª—å–Ω—ã—Ö —Å—Ç–æ—Ä–æ–Ω —Ä–∞–∑–Ω—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä
